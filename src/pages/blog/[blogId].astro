---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getBlogDetail, getBlogs } from "../../lib/microcms";
import formatDate from "../../utils/formatDate";

export async function getStaticPaths(){
	const response = await getBlogs({fields: ["id"]});
	return response.contents.map((content) => ({
			params: {
				blogId: content.id,
			},
		}))
};

const { blogId } = Astro.params;
const blog = await getBlogDetail(blogId as string);
---

<BaseLayout title={blog.title}>
	<main>
		<table>
			<tbody class="fields">
				<tr>
					<td>publishedAt:</td>
					<td>{formatDate(blog.publishedAt)}</td>
				</tr>
				{
				blog.publishedAt !== blog.updatedAt && 
				<tr>
					<td>updatedAt:</td>
					<td>{formatDate(blog.updatedAt)}</td>
				</tr>
				}
			</tbody>
		</table>
		<div set:html={blog.content}></div>
	</main>
</BaseLayout>

<style>
	.fields {
		color: gray;
		font-size: smaller;
	}
</style>